import{$b as I,Eb as p,Ff as re,Gb as y,Gf as de,Hf as le,Ib as d,Lf as ae,Ma as l,Nf as se,Of as ce,Pb as H,Pf as me,Qb as q,Rf as he,Sb as z,Sf as ue,Tb as K,Tf as pe,Uf as Ce,Vb as E,Vf as ge,Wb as b,Yb as f,_a as B,ac as N,bc as V,bd as J,cf as Y,db as O,eb as S,ef as Z,ha as m,hf as $,ia as h,ie as X,jf as ee,kb as M,kf as te,lb as D,mf as ne,nb as A,nf as oe,ob as C,pb as g,pc as s,qb as R,rf as ie,sb as W,sc as Q,ta as F,tb as j,tc as _,ua as L,ub as u,uc as U,va as T,vb as a,wb as c,xb as w,xc as G}from"./chunk-PGONIGEX.js";import{a as v,b as k}from"./chunk-ARLR7ZLP.js";var be=["popoverComponentId"],fe=()=>[P];function _e(o,t){if(o&1){let e=p();a(0,"ng-icon",12),y("longclick",function(i){m(e);let r=d();return h(r.onToggleState(i))}),c()}if(o&2){let e=d();K("rotate-90",e.computedOpen())}}function xe(o,t){o&1&&w(0,"div",3)}function ve(o,t){if(o&1&&w(0,"hlm-checkbox",8),o&2){let e=d();u("disabled",e.node().disabled)("indeterminate",e.isIndeterminate())("checked",e.isChecked())}}function ke(o,t){if(o&1&&(a(0,"label",10),b(1),c()),o&2){let e=d();l(),f(" ",e.node().secondTitle," ")}}function ye(o,t){if(o&1&&(a(0,"div",13),b(1,"..."),c(),a(2,"div"),b(3),c()),o&2){let e,n=d(2);l(2),E(n.metaClass()),l(),f(" ",(e=n.node().meta)==null?null:e.value," ")}}function Te(o,t){if(o&1&&C(0,ye,4,3),o&2){let e,n=d();g((e=n.node().meta)!=null&&e.value||((e=n.node().meta)==null?null:e.value)===0?0:-1)}}function we(o,t){if(o&1){let e=p();a(0,"global-number-slider",17),V("valueChange",function(i){m(e);let r=d(3);return N(r.node().meta.value,i)||(r.node().meta.value=i),h(i)}),c()}if(o&2){let e=d(3);I("value",e.node().meta.value),u("step",e.node().meta.step)("wheelStep",e.node().meta.wheelStep)("label",e.node().meta.label)("hideButtons",e.node().meta.hideButtons)("hideReset",e.node().meta.hideReset)("disabled",e.node().meta.disabled)("max",e.node().meta.max)("min",e.node().meta.min)("hideDeleteButton",!0)}}function Ee(o,t){if(o&1){let e=p();a(0,"label",16),b(1),a(2,"input",18),V("ngModelChange",function(i){m(e);let r=d(3);return N(r.node().meta.value,i)||(r.node().meta.value=i),h(i)}),c()()}if(o&2){let e=d(3);l(),f("",e.node().meta.label," "),l(),I("ngModel",e.node().meta.value),u("type",e.node().meta.type)("disabled",e.node().meta.disabled)("placeholder",e.node().meta.placeholder)}}function Ie(o,t){if(o&1){let e=p();a(0,"label",16),b(1),a(2,"input",19),V("ngModelChange",function(i){m(e);let r=d(3);return N(r.node().meta.value,i)||(r.node().meta.value=i),h(i)}),c()()}if(o&2){let e=d(3);l(),f("",e.node().meta.label," "),l(),I("ngModel",e.node().meta.value),u("min",e.node().meta.min)("max",e.node().meta.max)("disabled",e.node().meta.disabled)("placeholder",e.node().meta.placeholder)}}function Ne(o,t){if(o&1&&C(0,we,1,10,"global-number-slider",15)(1,Ee,3,5,"label",16)(2,Ie,3,6,"label",16),o&2){let e=d(2);g(e.isTreeNumberSlider()?0:e.isTreeString()?1:e.isTreeNumber()?2:-1)}}function Ve(o,t){if(o&1){let e=p();a(0,"div",14),y("keydown.enter",function(){m(e);let i=d();return h(i.onPopoverEnter())}),C(1,Ne,3,1),c()}if(o&2){let e=d();l(),g(e.hasValue()?1:-1)}}function Se(o,t){if(o&1){let e=p();a(0,"global-checkbox-tree-element",20),y("changed",function(i){m(e);let r=d(2);return h(r.emitChangesOfChilds(i))}),c()}if(o&2){let e=d(),n=e.$implicit,i=e.$index,r=d();z("max-height",r.computedOpen()?r.height():"0px")("opacity",r.computedOpen()?"1":"0"),u("node",n)("internalId",r.getInternalId(i))("rootLength",r.rootLength())("isVisible",r.computedOpen()&&r.isVisible())("setChecked",r.setChildsChecked())("metaVisibility",r.metaVisibility())}}function Me(o,t){o&1&&(S(0,Se,1,10),M(1,0,fe),D())}var P=class o{node=G.required();internalId=_.required();rootLength=_.required();changed=Q();setChecked=_();isVisible=_.required();metaVisibility=_("hover");popover=U("popoverComponentId");#t=24;internalIdPrefix="TREE";constructor(){L(()=>{this.setChecked()!==void 0&&T(()=>{let e=this.node().checked;this.node().disabled||(e!==void 0&&(e()?e.set(!1):e.set(!0)),this.emitChangesOfChilds(this.node()))})})}getInternalId(t){return[...this.internalId(),t]}computedClass=s(()=>{let t="flex flex-col pl-3 first:pl-3 first:border-l-0 border-l duration-200 overflow-hidden duration-200 ease-in-out origin-top animate-fadeIn ";return this.metaVisibility()==="hover"?t+="border-transparent group-hover:border-border group-focus:border-border group-hover:opacity-100 group-focus:opacity-100 ":t+="border-border opacity-100 ",t});metaClass=s(()=>{let t="elite-text-tiny line-clamp-1 pl-2 duration-200 ";return this.metaVisibility()==="hover"?t+="opacity-0 group-hover:opacity-100 group-focus:opacity-100 ":t+="border-border ",t});internalIdAsString=s(()=>this.internalId().join("."));setChildsChecked=F(void 0);computedOpen=s(()=>this.node().state()==="open"&&(!this.hasCheckbox()||this.isChecked()===!0||this.isIndeterminate()));height=s(()=>{let t=e=>e.children?.reduce((n,i)=>n+t(i),1)??1;return t(this.node())*this.#t+"px"});hasCheckbox=s(()=>this.node().checked!==void 0);hasValue=s(()=>this.node().meta!==void 0);isTreeNumberSlider=s(()=>pe(this.node().meta));isTreeString=s(()=>Ce(this.node().meta));isTreeNumber=s(()=>ge(this.node().meta));isIndeterminate=s(()=>{let t=this.node().checked;return t?t()==="indeterminate":!1});isChecked=s(()=>{let t=this.node().checked;return t&&t()?this.hasChildrens()?this.node().children?.every(e=>{let n=e.checked;return n===void 0||n()===!0})?(T(()=>{t.set(!0)}),!0):(T(()=>{t.set("indeterminate")}),!0):!!t():!1});hasChildrens=s(()=>this.childCount()>0);childCount=s(()=>this.node().children?.length??0);onChangeChecked(t){if(this.node().disabled&&t&&t.long)return;let e=this.node().checked;e&&(t&&t.long?(e&&!e()&&(e.set(!0),this.changed.emit(k(v({},this.node()),{path:[this.node().id]}))),this.setChildsChecked.set(this.setChildsChecked()!==void 0?!this.setChildsChecked():!1)):(this.hasChildrens()&&(e()===!0||e()==="indeterminate")?e.set(!1):e.set(!e()),this.changed.emit(k(v({},this.node()),{path:[this.node().id]}))))}onToggleState(t){if(t&&t.long){this.node().state.set(this.node().state()==="open"?"closed":"open");return}else this.onToggleAllStates()}onToggleAllStates(){let t=this.node().state()==="open"?"closed":"open",e=(n,i)=>{n.state.set(i),n.children?.forEach(r=>e(r,i))};e(this.node(),t)}emitChangesOfChilds(t){this.changed.emit(k(v({},t),{path:[this.node().id,...t.path??[]]}))}onContextMenu(t){t.preventDefault(),this.hasValue()&&requestAnimationFrame(()=>{this.popover()?.open()})}onPopoverEnter(){this.changed.emit(k(v({},this.node()),{path:[this.node().id]})),this.popover()?.close(0)}onKeyDown(t){switch(t.code){case"Space":this.node().disabled||this.onChangeChecked();break;case"Enter":this.hasValue()&&this.popover()?.open();break;case"ArrowRight":this.computedOpen()?this.onFocusFirstChild():this.isChecked()&&this.node().state.set("open");break;case"ArrowLeft":this.hasChildrens()?this.node().state()==="closed"?this.onFocusParent():this.node().state.set("closed"):this.onFocusParent();break;case"ArrowDown":{this.hasChildrens()&&this.computedOpen()?this.onFocusFirstChild():this.onFocusNextNode("down")||this.onFocusNextParent([...this.internalId()]);break}case"ArrowUp":{this.onFocusNextNode("up")||this.onFocusParent();break}case"Home":{this.onFocusFirstRoot();break}case"End":{this.onFocusLastRootChild();break}}}onFocusNextNode(t){let e=[...this.internalId()];if(t==="up"){let i=[...this.internalId()];if(i[i.length-1]-=1,this.#e(i))return!0;e[e.length-1]-=1}else e[e.length-1]+=1;let n=document.getElementById(this.internalIdPrefix+e.join("."));return n?(n.focus(),!0):!1}#e(t){let e=document.getElementById(this.internalIdPrefix+t.join("."));for(;e;){let n=parseInt(e.getAttribute("childrens")??"0"),i=e.getAttribute("open")==="true";if(n>0&&i)t.push(n-1),e=document.getElementById(this.internalIdPrefix+t.join("."));else break}return e?(e.focus(),!0):!1}onFocusFirstChild(){let t=[...this.internalId()];t.push(0);let e=document.getElementById(this.internalIdPrefix+t.join("."));e&&e.focus()}onFocusNextParent(t){if(t.length>0&&(t.pop(),t.length>0)){t[t.length-1]+=1;let e=document.getElementById(this.internalIdPrefix+t.join("."));e?e.focus():this.onFocusNextParent(t)}}onFocusParent(){let t=[...this.internalId()];t.pop();let e=document.getElementById(this.internalIdPrefix+t.join("."));e&&e.focus()}onFocusFirstRoot(){let t=document.getElementById(this.internalIdPrefix+"0");t&&t.focus()}onFocusLastRootChild(){this.#e([this.rootLength()-1])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=B({type:o,selectors:[["global-checkbox-tree-element"]],viewQuery:function(e,n){e&1&&H(n.popover,be,5),e&2&&q()},hostVars:2,hostBindings:function(e,n){e&2&&E(n.computedClass())},inputs:{node:[1,"node"],internalId:[1,"internalId"],rootLength:[1,"rootLength"],setChecked:[1,"setChecked"],isVisible:[1,"isVisible"],metaVisibility:[1,"metaVisibility"]},outputs:{node:"nodeChange",changed:"changed"},decls:18,vars:11,consts:[["popoverComponentId",""],[1,"flex","-translate-x-2.5","items-center"],["hlm","","LongPress","","name","featherChevronRight",1,"mr-1","min-w-6","duration-300",3,"rotate-90"],[1,"min-h-6","min-w-7"],[1,"flex","w-full","items-center","justify-start",3,"sideOffset"],["LongPress","",1,"focus:ring-ring","focus:ring-offset-background","rounded-sm","outline-hidden","focus:ring-2","focus:ring-offset-2",3,"auxclick","keydown","longclick","id","tabindex"],["brnPopoverTrigger","",1,"pointer-events-none","invisible","absolute","-z-50"],["LabelContainer","","variant","horizontal"],[1,"pointer-events-none",3,"disabled","indeterminate","checked"],["inert","","hlmLabel","",1,"pointer-events-none","truncate","select-none"],["inert","","hlmLabel","",1,"pointer-events-none","truncate","text-xs","opacity-70","select-none"],["hlmPopoverContent","",3,"keydown.enter",4,"brnPopoverContent"],["hlm","","LongPress","","name","featherChevronRight",1,"mr-1","min-w-6","duration-300",3,"longclick"],[1,"elite-text-tiny","text-muted-foreground","pl-2","select-none"],["hlmPopoverContent","",3,"keydown.enter"],[3,"value","step","wheelStep","label","hideButtons","hideReset","disabled","max","min","hideDeleteButton"],["hlmLabel",""],[3,"valueChange","value","step","wheelStep","label","hideButtons","hideReset","disabled","max","min","hideDeleteButton"],["hlmInput","","size","sm","spellcheck","false","autocomplete","false",3,"ngModelChange","ngModel","type","disabled","placeholder"],["hlmInput","","size","sm","spellcheck","false","autocomplete","false","type","number",3,"ngModelChange","ngModel","min","max","disabled","placeholder"],[3,"changed","node","internalId","rootLength","isVisible","setChecked","metaVisibility"]],template:function(e,n){if(e&1){let i=p();a(0,"div",1),C(1,_e,1,2,"ng-icon",2)(2,xe,1,0,"div",3),a(3,"global-popover",4,0)(5,"button",5),y("auxclick",function(x){return m(i),h(n.onContextMenu(x))})("keydown",function(x){return m(i),h(n.onKeyDown(x))})("longclick",function(x){return m(i),h(n.onChangeChecked(x))}),w(6,"button",6),a(7,"div",7),C(8,ve,1,3,"hlm-checkbox",8),a(9,"label",9),b(10),c(),C(11,ke,2,1,"label",10),c()(),S(12,Te,1,1),M(13,12),D(),O(15,Ve,2,1,"div",11),c()(),W(16,Me,3,0,null,null,R)}e&2&&(l(),g(n.hasChildrens()?1:2),l(2),u("sideOffset",32),l(2),E(n.node().disabled?"cursor-not-allowed opacity-75":"cursor-pointer"),u("id",n.internalIdPrefix+n.internalIdAsString())("tabindex",n.isVisible()?1:-1),A("childrens",n.childCount())("open",n.computedOpen()),l(3),g(n.hasCheckbox()?8:-1),l(2),f(" ",n.node().title," "),l(),g(n.node().secondTitle?11:-1),l(5),j(n.node().children))},dependencies:[ie,Z,te,$,oe,ne,ee,le,se,J,Y,X,ae,ue,re,de,ce,he,me],encapsulation:2,changeDetection:0})};export{P as CheckboxTreeElementComponent};
